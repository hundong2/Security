# MITM(중간자 공격)이란?
통신 중간에 공격자가 끼어들어 양쪽과 각각 통신하면서 **도청·변조·위조**를 가능하게 만드는 공격입니다. 특히 “인증 없는 키 교환(DH/ECDH)”에서 핵심 위협입니다.

## 예시 파일
[OWASP: Man-in-the-middle Attack](https://owasp.org/www-community/attacks/Man-in-the-middle_attack)

## 답변
MITM(Man-In-The-Middle)의 핵심은 **A↔B가 직접 통신한다고 믿게 만들고**, 실제로는 **A↔공격자↔B**로 통신 경로를 재구성하는 것입니다.

### 1) 어떤 일이 벌어지나(직관)
- A는 “B에게 보낸다”고 생각하지만 실제로는 공격자 M에게 보냄
- M은 내용을 읽거나 바꾼 뒤 B에게 전달
- B도 “A에게서 왔다”고 믿음  
→ 결과적으로 **기밀성(비밀 유지)** 과 **무결성/인증(변조 방지/상대 확인)** 이 깨질 수 있습니다.

### 2) 키 교환에서 왜 특히 문제인가?
인증 없는 Diffie–Hellman(ECDH/X25519 포함)은 “공유 비밀을 만들 수 있음”만 보장하고, **그 공유 비밀이 ‘누구와’ 만들어졌는지**는 보장하지 않습니다.

공격 흐름(요약):
1. A가 공개키 `A_pub`를 B에게 보냄 → M이 가로챔
2. M이 자기 공개키 `M1_pub`를 B에게 보냄(마치 A인 것처럼)
3. B가 공개키 `B_pub`를 A에게 보냄 → M이 가로챔
4. M이 자기 공개키 `M2_pub`를 A에게 보냄(마치 B인 것처럼)

결과:
- A는 `A↔M`의 공유키를 만들고,
- B도 `B↔M`의 공유키를 만듭니다.
- M은 두 키를 모두 알고 있으니 **A의 메시지를 복호화 → (필요하면 수정) → B에게 재암호화**할 수 있습니다.

즉, 암호 알고리즘이 “깨진” 게 아니라, **인증이 없어서 공격자가 합법 참가자처럼 행동**할 수 있는 겁니다.

### 3) 어떻게 막나(방어책)
- **인증을 결합**해야 합니다.
  - 인증서 + 서명(TLS에서 서버 인증)
  - PSK(사전 공유 키)
  - PAKE(비밀번호 기반 키 교환, 예: OPAQUE, SRP)
- 실무적으로는 “키 교환 + 인증 + KDF + AEAD”를 세트로 사용합니다(TLS 1.3 구조).

### 추가 자료
- [RFC 8446: TLS 1.3(키 교환과 인증 결합)](https://www.rfc-editor.org/rfc/rfc8446)
- [RFC 7748: X25519/X448(키 교환 알고리즘)](https://www.rfc-editor.org/rfc/rfc7748)